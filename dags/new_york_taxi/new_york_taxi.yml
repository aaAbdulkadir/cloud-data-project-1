new_york_taxi:
  owner: Abdulkadir
  description: Getting new york taxi data
  schedule_interval: '0 9 * * *'
  url: https://d37ci6vzurychx.cloudfront.net/trip-data/{taxi_type}_tripdata_{year}-{month}.parquet
  
  email_on_failure: True
  email_on_retry: False
  email_on_success: False
  email: a.abdulkadir@hotmail.com
  
  python_callable_file: new_york_taxi_functions.py  
  config_path: config/config.json
  
  tasks:
    extract_yellow: &extract
      python_callable: extract
      params:
        - taxi_type: yellow

    extract_green:
      <<: *extract
      params:
        - taxi_type: green


    transform_yellow: &transform
      python_callable: transform
      dependencies:
        - extract_yellow

    transform_green:
      << : *transform
      dependencies:
        - extract_green
        
        
    load_yellow: &load
      mode: append
      dataset_name: new_york_taxi
      fields:
        - name: Date
          type: Date
        - name: Time
          type: Varchar(100)
        - name: Service 
          type: Varchar(100)
        - name: Time
          type: Varchar(100)
      dependencies:
        - transform_yellow

    load_green:
      <<: *load
      dependencies:
        - transform_green

